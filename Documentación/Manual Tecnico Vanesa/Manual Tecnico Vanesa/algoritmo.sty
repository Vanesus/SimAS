
%%%%%%%%%%% Code examples in text

%% Algorithm

\newcount\algocount
\def\looker{\ifx\next\end\else\ifx\next\lineending\vskip-4pt%
\noindent\qquad\else\global\advance\algocount by1\relax%
\vskip0pt\noindent\hskip12pt\hbox to0pt{\hss{\bf [\the\algocount]}}\quad\fi\fi}

\def\lineending{\parfillskip=0pt plus1fil\relax\futurelet\next\looker}

{\obeylines
\gdef\algorithm{\medskip
\def\note##1{\parfillskip=0pt\hfill##1}\def\ {\qquad}%
\baselineskip=12pt\parskip=2pt\obeylines\let^^M=\lineending}}

\def\endalgorithm{\vskip1pt}

%% code example

\newif\ifcodeon
\newif\ifneedspace
{\obeylines\obeyspaces

\gdef\codelooker{\ifx\next\lineending\vskip-4pt%
\noindent\else%
\ifx\next\end\vskip-4pt\let^^M\ \endcodesamp\else%
\vskip0pt\noindent\fi\fi}

\gdef\codelineending{\relax\futurelet\next\codelooker}

\gdef\codesamp{\small\smallskip\global\codeontrue\baselineskip=12pt%
\parskip=2pt\tt\obeylines\obeyspaces\let^^M=\codelineending}

\gdef\endcodesamp{\global\codeonfalse\smallskip}

\gdef\spcodesamp{\baselineskip=12pt%
\parskip=2pt\tt\obeylines\obeyspaces\let^^M=\codelineending}

\gdef\codebox#1{\let\go\relax%
\ifcodeon\else\global\needspacetrue\let\go\spcodesamp\fi\go%
\global\dimen1=#1\relax\global\setbox0=\vbox\bgroup}

\gdef\endcodebox{\ifneedspace\global\needspacefalse\vskip\baselineskip\fi%
\egroup%
\vtop to \ht0{\vskip-3pt\hrule\hbox to\dimen1{\vrule height\ht0%
\hfill\vrule height\ht0 depth \dp0}\hrule\vss}%
\nobreak\vskip-\ht0\rlap{\hskip6pt\vbox{\unvbox0}}}}


%% Theorems, Proofs, Examples, etc.

\def\demo#1{\vskip-\lastskip
\bigskip
\noindent{\it#1.\/} }
\def\enddemo{\vskip12pt}

\def\example{\vskip-\lastskip
\bigskip
\noindent{\it Example:\/} }


\def\inmathqed{\global\inmathqedtrue}

\def\qed{\penalty-250%
\hbox to 6pt{\hfill}\hfill\llap{%
\vbox{\hrule\hbox{\vrule height6pt\hskip6pt\vrule}\hrule}}}

\def\slug{\penalty-250%
\hbox to 6pt{\hfill}\hfill\llap{\vrule height 6pt width 6pt depth0pt}}

\def\proof{\vskip-\lastskip
\bigskip
\futurelet\next\lookforbracket}

\def\lookforbracket{\ifx\next[\let\go\usespecialterm
\else\let\go\relax
\noindent{\bf Proof:}\enskip\relax\ignorespaces\fi\go}

\def\usespecialterm[#1]{%
\noindent\hbox{\bf #1:}\enskip\relax\ignorespaces}


\def\endproof{\ifqedequation\global\qedequationfalse\vskip-6pt%
\vskip-\belowdisplayskip\hfill\slug\else
\ifinmathqed\smallskip\else\slug\smallskip\fi\fi%
\global\inmathqedfalse}

\let\endexample\endproof

\def\proclaim#1{\vskip-\lastskip
\bigskip
\bgroup\noindent\hbox{\bf#1}\enskip\it\ignorespaces}
\def\endproclaim{\egroup}

%%%% Computer Window example

\newbox\wrapbox
\def\window{\bgroup\obeylines\let\par\cr%
\global\setbox\wrapbox=\vtop\bgroup\obeylines\let\par\cr%
\halign\bgroup\it\strut##\hfil\cr}

\def\endwindow{\crcr\egroup\egroup%
\raise8.5pt\vtop{\hrule
\hbox{\vrule height 14pt\hskip6pt{%
\obeylines\let\par\cr\vtop{\vskip-20pt\copy\wrapbox\vskip4pt}}%
\hskip6pt\vrule}\hrule}\egroup%
\vskip12pt}

\def\winline#1#2{\vskip12pt%
\hskip-24pt\hbox to24pt{#1\hss}%
\hbox to7.5pc{#2\hfil}}

\def\endwinline{\vskip1pt}

\def\interface{\bgroup\small\leftmargini 45pt
\leftskip=24pt \parindent=0pt}

\def\endinterface{\vskip1sp\egroup\vskip1sp}

%%%%%%
